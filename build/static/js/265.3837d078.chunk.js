"use strict";(self.webpackChunkaiops_fe=self.webpackChunkaiops_fe||[]).push([[265],{8047:(e,t,s)=>{s.d(t,{A:()=>r});var a=s(5043),l=s(579);const r=e=>{let{range:t}=e;const[s,r]=(0,a.useState)("");return(0,l.jsxs)("select",{id:"date-range",value:s,onChange:e=>{r(e.target.value),t(e.target.value)},className:"bg-gray-50 border border-gray-300 text-gray-900 mb-2 text-sm w-[150px] focus:outline-none block p-1",children:[(0,l.jsx)("option",{disabled:!0,value:"",children:"Select Date Range"}),["last 30 min","last 1 hour","last 6 hours","last 24 hours","All Problems"].map(((e,t)=>(0,l.jsx)("option",{value:e,children:e},t)))]})}},265:(e,t,s)=>{s.r(t),s.d(t,{default:()=>o});var a=s(5043),l=s(3216),r=s(594),c=s(8047),n=s(9423),i=s(579);const o=()=>{const{isLoading:e,error:t,data:s,getData:o}=(0,r.A)(),[d,m]=(0,a.useState)([]),[x,p]=(0,a.useState)([]),[h,u]=(0,a.useState)(""),[b,g]=(0,a.useState)(""),[j,v]=(0,a.useState)(),N=(0,l.Zp)(),{id:f}=(0,l.g)();(0,a.useEffect)((()=>{o("/get_audit_data")}),[]),(0,a.useEffect)((()=>{if(m(s),f){const e=null===s||void 0===s?void 0:s.filter((e=>"closed"==f?"CLOSED"===e.status:"open"==f?"OPEN"===e.status:"in-progress"==f?"IN_PROGRESS"===e.status:void 0));"closed"==f&&u((e=>"CLOSED")),"open"==f&&u((e=>"OPEN")),"in-progress"==f&&u((e=>"IN_PROGRESS")),p(e)}else p(s)}),[s]);(0,a.useEffect)((()=>{if(d){const e=null===d||void 0===d?void 0:d.filter((e=>(""===h||e.status===h)&&(""===b||e.serviceNamem===b)));if(j){console.log(new Date(j),"range"),console.log(new Date,"now");new Date;const t=null===e||void 0===e?void 0:e.filter((e=>{console.log((0,n.xH)(null===e||void 0===e?void 0:e.problemDetectedAt),"time");const t=(0,n.xH)(null===e||void 0===e?void 0:e.problemDetectedAt);return new Date(j)<=t}));p((e=>t))}else p((t=>e))}}),[b,h,j,f]);const y=(e,t)=>{if(e&&t){const s=Math.floor((new Date(t)-new Date(e))/6e4);return"".concat(s," min")}return"N/A"};return(0,i.jsxs)("div",{className:"p-5",children:[(0,i.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center mb-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-xl font-semibold",children:"Remediation Execution Records"}),(0,i.jsx)("p",{children:"View the execution history of remediation actions."})]}),(0,i.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mt-4 md:mt-0",children:[(0,i.jsx)(c.A,{range:e=>{(e=>{const t=new Date;let s;switch(e){case"last 30 min":s=new Date(t.getTime()-18e5);break;case"last 1 hour":s=new Date(t.getTime()-36e5);break;case"last 6 hours":s=new Date(t.getTime()-216e5);break;case"last 24 hours":s=new Date(t.getTime()-864e5);break;default:return v((e=>null)),null}const a=Math.floor(s.getTime());v((e=>a))})(e)}}),(0,i.jsxs)("select",{className:"bg-gray-50 border border-gray-300 text-gray-900 mb-2 text-sm w-[150px] focus:outline-none block p-1",id:"remediation-filter",onChange:e=>{const t=e.target.value;g((e=>t))},children:[(0,i.jsx)("option",{value:"",children:"Filter by Service Name"}),(0,i.jsx)("option",{value:"apache2",children:"Apache2"}),(0,i.jsx)("option",{value:"OneAgent",children:"OneAgent"}),(0,i.jsx)("option",{value:"MySQL",children:"MySQL"})]}),(0,i.jsxs)("select",{className:"bg-gray-50 border border-gray-300 text-gray-900 mb-2 text-sm w-[150px] focus:outline-none block p-1",id:"status-filter",onChange:e=>{const t=e.target.value;u((e=>t))},value:h||"",children:[(0,i.jsx)("option",{value:"",children:"Filter by Status"}),(0,i.jsx)("option",{value:"OPEN",children:"Open"}),(0,i.jsx)("option",{value:"CLOSED",children:"Closed"}),(0,i.jsx)("option",{value:"IN_PROGRESS",children:"In Progress"}),(0,i.jsx)("option",{value:"FAILED",children:"Failed"})]})]})]}),(0,i.jsxs)("div",{className:"px-5 py-2 w-full h-[calc(100vh-190px)] overflow-auto",children:[(0,i.jsx)("div",{className:"hidden md:block",children:0!==x.length?(0,i.jsxs)("table",{className:"w-full bg-white shadow-sm text-sm text-left",children:[(0,i.jsx)("thead",{className:"bg-gray-200 text-xs",children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"p-3 text-center",children:"DisplayID"}),(0,i.jsx)("th",{className:"p-3 text-center",children:"Problem Title"}),(0,i.jsx)("th",{className:"p-3 text-center",children:"Problem Impact"}),(0,i.jsx)("th",{className:"p-3 text-center",children:"Problem Severity"}),(0,i.jsx)("th",{className:"p-3 text-center",children:"Status"}),(0,i.jsx)("th",{className:"p-3 text-center",children:"Service Name"}),(0,i.jsx)("th",{className:"p-3 text-center",children:"Actual Downtime"}),(0,i.jsx)("th",{className:"p-3 text-center",children:"Action Type"})]})}),(0,i.jsx)("tbody",{children:null===x||void 0===x?void 0:x.map(((e,t)=>(0,i.jsxs)("tr",{className:"hover:bg-gray-50",onClick:()=>N("/".concat(e.pid,"/").concat(e.executedProblemId,"/").concat(e.id)),children:[(0,i.jsx)("td",{className:"p-2 text-center",children:e.displayId}),(0,i.jsx)("td",{className:"p-2 text-start truncate max-w-60",children:e.problemTitle}),(0,i.jsx)("td",{className:"p-2 text-center",children:e.problemImpact}),(0,i.jsx)("td",{className:"p-2 text-center",children:e.problemSeverity}),(0,i.jsx)("td",{className:"p-2 text-center",children:e.status}),(0,i.jsx)("td",{className:"p-2 text-start truncate max-w-60",children:e.serviceName}),(0,i.jsx)("td",{className:"p-2 text-center",children:y(e.problemDetectedAt,e.problemEndAt)}),(0,i.jsx)("td",{className:"p-2 text-center",children:e.actionType.toUpperCase()})]},t)))})]}):(0,i.jsx)("p",{className:"flex justify-center p-5 font-semibold",children:"No Avilable Problems."})}),(0,i.jsx)("div",{className:"md:hidden space-y-4",children:null===x||void 0===x?void 0:x.map(((e,t)=>(0,i.jsxs)("div",{className:"p-4 bg-white  shadow-md border hover:bg-gray-50",onClick:()=>N("/".concat(e.pid,"/").concat(e.executedProblemId,"/").concat(e.id)),children:[(0,i.jsxs)("p",{className:"text-sm text-gray-600",children:["ID: ",e.displayId]}),(0,i.jsxs)("p",{className:"text-sm font-semibold text-gray-800 truncate",children:["Title: ",e.problemTitle]}),(0,i.jsxs)("p",{className:"text-sm text-gray-600 truncate",children:["Sub Title: ",e.subProblemTitle||"N/A"]}),(0,i.jsxs)("p",{className:"text-sm text-gray-600",children:["Impact: ",e.problemImpact]}),(0,i.jsxs)("p",{className:"text-sm text-gray-600",children:["Severity: ",e.problemSeverity]}),(0,i.jsxs)("p",{className:"text-sm text-gray-600 truncate",children:["Service: ",e.serviceName]}),(0,i.jsxs)("p",{className:"text-sm text-gray-600",children:["Status: ",e.status]}),(0,i.jsxs)("p",{className:"text-sm text-gray-600",children:["Downtime: ",y(e.problemDetectedAt,e.problemEndAt)," min"]}),(0,i.jsxs)("p",{className:"text-sm text-gray-600",children:["Action: ",e.actionType.toUpperCase()]}),(0,i.jsxs)("p",{className:"text-sm text-gray-600 truncate",children:["Comment: ",e.comments]})]},t)))})]})]})}}}]);
//# sourceMappingURL=265.3837d078.chunk.js.map